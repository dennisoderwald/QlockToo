//
// Matrix.ino
//

#include "globals.h"

const uint16_t hours[][2] = {
    // row, mask
    {5, 0b1111000000000000},  // EINS
    {5, 0b0000000111100000},  // ZWEI
    {6, 0b1111000000000000},  // DREI
    {6, 0b0000000111100000},  // VIER
    {4, 0b0000000111100000},  // FUENF
    {7, 0b1111100000000000},  // SECHS
    {8, 0b1111110000000000},  // SIEBEN
    {7, 0b0000000111100000},  // ACHT
    {9, 0b0001111000000000},  // NEUN
    {9, 0b1111000000000000},  // ZEHN
    {4, 0b0000011100000000},  // ELF
    {8, 0b0000000111100000}   // ZWOELF
};

const uint16_t words[][2] = {
    // row,mask
    {0, 0b1100000000000000},  // ES
    {0, 0b0001110000000000},  // IST
    {0, 0b0000000111100000},  // FÜNF
    {1, 0b1111000000000000},  // ZEHN
    {2, 0b0000111111110000},  // VIERTEL
    {1, 0b0000111111100000},  // ZWANZIG
    {3, 0b1110000000000000},  // VOR
    {3, 0b0000000111100000},  // NACH
    {4, 0b1111000000000000},  // HALB
    {9, 0b0000000011100000}   // UHR
};

const byte number[][7] = {
    {
        0b00001110,   // 0
        0b00010001,
        0b00010011,
        0b00010101,
        0b00011001,
        0b00010001,
        0b00001110
    },
    {
        0b00000100,   // 1
        0b00001100,
        0b00000100,
        0b00000100,
        0b00000100,
        0b00000100,
        0b00001110
    },
    {
        0b00001110,   // 2
        0b00010001,
        0b00000001,
        0b00000010,
        0b00000100,
        0b00001000,
        0b00011111
    },
    {
        0b00011111,   // 3
        0b00000010,
        0b00000100,
        0b00000010,
        0b00000001,
        0b00010001,
        0b00001110
    },
    {
        0b00000010,   // 4
        0b00000110,
        0b00001010,
        0b00010010,
        0b00011111,
        0b00000010,
        0b00000010
    },
    {
        0b00011111,   // 5
        0b00010000,
        0b00011110,
        0b00000001,
        0b00000001,
        0b00010001,
        0b00001110
    },
    {
        0b00000110,   // 6
        0b00001000,
        0b00010000,
        0b00011110,
        0b00010001,
        0b00010001,
        0b00001110
    },
    {
        0b00011111,   // 7
        0b00000001,
        0b00000010,
        0b00000100,
        0b00001000,
        0b00001000,
        0b00001000
    },
    {
        0b00001110,   // 8
        0b00010001,
        0b00010001,
        0b00001110,
        0b00010001,
        0b00010001,
        0b00001110
    },
    {
        0b00001110,   // 9
        0b00010001,
        0b00010001,
        0b00001111,
        0b00000001,
        0b00000010,
        0b00001100
    }
};


void matrix_clear(uint16_t (&matrix)[ROWS][COLS])
{
    for (int y = 0; y < ROWS; y++)
        for (int x = 0; x < COLS; x++)
            matrix[y][x] = 0;
}


void matrix_second(uint16_t (&matrix)[ROWS][COLS], int s)
{
    // split second in left and right part
    int s_1 = s / 10;
    int s_2 = s % 10;

    for (int y = 0; y < ROWS; y++)
    {
        for (int x = 0; x < COLS; x++)
        {
            // first two rows and last row is always empty
            if (y < 2 || y == 10)
                matrix[y][x] = 0;

            // print number
        }
    }
}


void matrix_timewords(uint16_t (&matrix)[ROWS][COLS], int hour, int minute)
{
    // Binary mask for columns:
    // ES,IST,FÜNF,ZEHN,VIERTEL,ZWANZIG,VOR,NACH,HALB,Stunde,Stunde+1,UHR
    uint16_t selector[] =
    {
        0b110000000101,  // 0
        0b111000010100,  // 5
        0b110100010100,  // 10
        0b110010010100,  // 15
        0b110001010100,  // 20
        0b111000101010,  // 25
        0b110000001010,  // 30
        0b111000011010,  // 35
        0b110001100010,  // 40
        0b110010100010,  // 45
        0b110100100010,  // 50
        0b111000100010   // 55
    }

    uint16_t action = selector[minute / 5];

}
